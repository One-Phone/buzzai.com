---
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";

interface MetaTags {
  title?: string;
  description?: string;
  ogLocale?: string;
  ogType?: string;
  ogTitle?: string;
  ogUrl?: string;
  ogSiteName?: string;
  twitterCard?: string;
  canonicalUrl?: string;
  nextPageUrl?: string;
  preloadImage?: {
    srcset: string;
    sizes: string;
  };
}

interface Props {
  className?: string;
  meta?: MetaTags;
  jsonLd?: any;
}

const {
  className = "category-dating category-52",
  meta = {
    title: "Category - Hushed | Secure second and temporary phone number app",
    description: "Default category description",
    ogLocale: "en_US",
    ogType: "article",
    ogTitle: "Category - Hushed | Secure second and temporary phone number app",
    ogUrl: "https://hushed.com/category/",
    ogSiteName: "Hushed | Secure second and temporary phone number app",
    twitterCard: "summary_large_image",
    canonicalUrl: "https://hushed.com/category/",
  },
  jsonLd = {},
} = Astro.props;
---

<!doctype html>
<html class="no-js no-svg" lang="en-US">
  <head>
    <meta charset="UTF-8" />

    <link
      rel="stylesheet"
      id="template-archive-css"
      href="/css/templates/archive.css"
      type="text/css"
      media="all"
    />
    <link
      rel="stylesheet"
      id="app-css"
      href="/css/app.css"
      type="text/css"
      media="all"
    />
    <link
      rel="stylesheet"
      id="wp-block-library-css"
      href="/css/style.min.css"
      type="text/css"
      media="all"
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Meta tags -->
    <title>{meta.title}</title>
    {meta.description && <meta name="description" content={meta.description} />}

    <!-- Open Graph -->
    {meta.ogLocale && <meta property="og:locale" content={meta.ogLocale} />}
    {meta.ogType && <meta property="og:type" content={meta.ogType} />}
    {meta.ogTitle && <meta property="og:title" content={meta.ogTitle} />}
    {meta.ogUrl && <meta property="og:url" content={meta.ogUrl} />}
    {
      meta.ogSiteName && (
        <meta property="og:site_name" content={meta.ogSiteName} />
      )
    }

    <!-- Twitter -->
    {
      meta.twitterCard && (
        <meta name="twitter:card" content={meta.twitterCard} />
      )
    }

    <!-- Canonical & Navigation -->
    {meta.canonicalUrl && <link rel="canonical" href={meta.canonicalUrl} />}
    {meta.nextPageUrl && <link rel="next" href={meta.nextPageUrl} />}

    <!-- Preload Images -->
    {
      meta.preloadImage && (
        <link
          rel="preload"
          data-rocket-preload
          as="image"
          imagesrcset={meta.preloadImage.srcset}
          imagesizes={meta.preloadImage.sizes}
          fetchpriority="high"
        />
      )
    }

    <!-- JSON-LD -->
    {
      Object.keys(jsonLd).length > 0 && (
        <script type="application/ld+json" set:html={JSON.stringify(jsonLd)} />
      )
    }

    <!-- Page-specific head content -->
    <slot name="head" />

    <!-- Analytics Scripts -->
    <script is:inline>
      (function (c, s, q, u, a, r, e) {
        c.hj =
          c.hj ||
          function () {
            (c.hj.q = c.hj.q || []).push(arguments);
          };
        c._hjSettings = { hjid: a };
        r = s.getElementsByTagName("head")[0];
        e = s.createElement("script");
        e.async = true;
        e.src = q + c._hjSettings.hjid + u;
        r.appendChild(e);
      })(
        window,
        document,
        "https://static.hj.contentsquare.net/c/csq-",
        ".js",
        5220589
      );
    </script>
    <script
      type="text/javascript"
      src="/js/vendor/jquery.min.js"
      id="jquery-core-js"
      data-rocket-defer
      defer></script>
    <script
      type="text/javascript"
      src="/js/vendor/jquery-migrate.min.js"
      id="jquery-migrate-js"
      data-rocket-defer
      defer></script>
    <script
      type="text/javascript"
      src="/js/manifest.js"
      id="manifest-js"
      data-rocket-defer
      defer></script>
    <script
      type="text/javascript"
      src="/js/templates/index.js"
      id="template-index-js"
      data-rocket-defer
      defer></script>

    <!-- Add missing CSS files -->
    <link
      rel="stylesheet"
      id="app-css"
      href="/css/app.css"
      type="text/css"
      media="all"
    />
    <link
      rel="stylesheet"
      id="template-archive-css"
      href="/css/templates/archive.css"
      type="text/css"
      media="all"
    />

    <!-- Add WP emoji styles -->
    <style id="wp-emoji-styles-inline-css" type="text/css">
      img.wp-smiley,
      img.emoji {
        display: inline !important;
        border: none !important;
        box-shadow: none !important;
        height: 1em !important;
        width: 1em !important;
        margin: 0 0.07em !important;
        vertical-align: -0.1em !important;
        background: none !important;
        padding: 0 !important;
      }
    </style>

    <!-- Add safe SVG styles -->
    <style id="safe-svg-svg-icon-style-inline-css" type="text/css">
      .safe-svg-cover {
        text-align: center;
      }
      .safe-svg-cover .safe-svg-inside {
        display: inline-block;
        max-width: 100%;
      }
      .safe-svg-cover svg {
        height: 100%;
        max-height: 100%;
        max-width: 100%;
        width: 100%;
      }
    </style>

    <!-- Add classic theme styles -->
    <style id="classic-theme-styles-inline-css" type="text/css">
      .wp-block-button__link {
        color: #fff;
        background-color: #32373c;
        border-radius: 9999px;
        box-shadow: none;
        text-decoration: none;
        padding: calc(0.667em + 2px) calc(1.333em + 2px);
        font-size: 1.125em;
      }
      .wp-block-file__button {
        background: #32373c;
        color: #fff;
        text-decoration: none;
      }
    </style>
  </head>
  <body
    class={`archive category loading-fonts ${className}`}
    data-template="base.twig"
    data-bg-color="bg-primary"
  >
    <Header />
    <div class="overlay-mob-menu load bg-primary"></div>

    <slot />

    <Footer />

    <div
      class="svg-defs"
      style="position:fixed; opacity: 0; pointer-events: none; left: -200vw; font-size: 0"
    >
      <svg>
        <defs>
          <symbol id="icon-logo" viewBox="0 0 140 30" fill="none">
            <path
              d="M22.419 13.371C22.04 13.7523 21.7498 14.2125 21.569 14.7187C21.3882 15.225 21.3213 15.7649 21.373 16.3L21.355 16.282C21.4082 16.9119 21.3232 17.5457 21.1061 18.1394C20.889 18.733 20.545 19.2721 20.0981 19.7191C19.6511 20.166 19.112 20.5101 18.5183 20.7271C17.9247 20.9442 17.2908 21.0292 16.661 20.976L16.679 20.994C15.9256 20.9239 15.1689 21.0878 14.512 21.4635C13.8552 21.8392 13.3302 22.4083 13.0087 23.0933C12.6872 23.7783 12.5847 24.5457 12.7153 25.2911C12.846 26.0364 13.2033 26.7233 13.7386 27.2581C14.2739 27.7929 14.9611 28.1496 15.7065 28.2795C16.452 28.4095 17.2193 28.3063 17.904 27.9842C18.5887 27.662 19.1573 27.1366 19.5324 26.4794C19.9075 25.8222 20.0708 25.0654 20 24.312L20.019 24.33C19.9658 23.7002 20.0507 23.0663 20.2678 22.4726C20.4849 21.879 20.829 21.3399 21.2759 20.8929C21.7229 20.446 22.262 20.1019 22.8556 19.8849C23.4493 19.6678 24.0831 19.5828 24.713 19.636L24.694 19.618C25.3094 19.6733 25.9289 19.5724 26.495 19.3246C27.061 19.0768 27.5554 18.6901 27.9322 18.2004C28.309 17.7107 28.5562 17.1337 28.6506 16.5231C28.7451 15.9124 28.6839 15.2878 28.4727 14.707C28.2615 14.1263 27.9071 13.6083 27.4424 13.201C26.9777 12.7937 26.4177 12.5103 25.8143 12.3771C25.2109 12.2439 24.5836 12.2651 23.9906 12.4388C23.3976 12.6126 22.8581 12.9332 22.422 13.371H22.419Z"
              fill="currentColor"></path>
          </symbol>

          <symbol
            id="stars"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M19 1L17.74 3.75L15 5L17.74 6.26L19 9L20.25 6.26L23 5L20.25 3.75M9 4L6.5 9.5L1 12L6.5 14.5L9 20L11.5 14.5L17 12L11.5 9.5M19 15L17.74 17.74L15 19L17.74 20.25L19 23L20.25 20.25L23 19L20.25 17.74"
              fill="currentColor"></path>
          </symbol>

          <symbol
            id="arrow"
            width="20"
            height="20"
            viewBox="0 0 20 20"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M3.75021 9.16661L13.4052 9.16661L9.65522 5.41661L10.8335 4.23828L16.5952 9.99995L10.8335 15.7616L9.65521 14.5833L13.4052 10.8333L3.75021 10.8333L3.75021 9.16661Z"
              fill="currentColor"></path>
          </symbol>
        </defs>
      </svg>

      <!-- Filter: https://css-tricks.com/gooey-effect/ -->
      <svg
        style="visibility: hidden; position: absolute;"
        width="0"
        height="0"
        xmlns="http://www.w3.org/2000/svg"
        version="1.1"
      >
        <defs>
          <filter id="goo">
            <fegaussianblur in="SourceGraphic" stddeviation="10" result="blur"
            ></fegaussianblur>
            <fecolormatrix
              in="blur"
              values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9"
              result="goo"></fecolormatrix>
            <fecomposite in="SourceGraphic" in2="goo" operator="atop"
            ></fecomposite>
          </filter>
        </defs>
      </svg>
    </div>

    <!-- Common scripts -->
    <script is:inline>
      // Lazy loading script
      const loadScriptsTimer = setTimeout(loadScripts, 2 * 1000);
      const userInteractionEvents = [
        "mouseover",
        "keydown",
        "touchstart",
        "touchmove",
        "wheel",
      ];

      userInteractionEvents.forEach(function (event) {
        window.addEventListener(event, triggerScriptLoader, { passive: true });
      });

      function triggerScriptLoader() {
        loadScripts();
        clearTimeout(loadScriptsTimer);
        userInteractionEvents.forEach(function (event) {
          window.removeEventListener(event, triggerScriptLoader, {
            passive: true,
          });
        });
      }

      function loadScripts() {
        document
          .querySelectorAll("script[data-type='lazy']")
          .forEach(function (elem) {
            elem.setAttribute("src", elem.getAttribute("data-src"));
          });
      }
    </script>

    <!-- Cookie and analytics scripts -->
    <script
      type="text/javascript"
      id="Cookiebot"
      src="https://consent.cookiebot.com/uc.js"
      data-cbid="ac1cfd27-af6e-4f4c-b043-e7d4aaa43d53"
      data-blockingmode="auto"
      data-rocket-defer
      defer></script>

    <!-- YouTube lazy loading script -->
    <script is:inline>
      function lazyLoadThumb(e, alt, l) {
        var t =
            '<img src="https://i.ytimg.com/vi/ID/hqdefault.jpg" alt="" width="480" height="360">',
          a = '<button class="play" aria-label="play Youtube video"></button>';
        if (l) {
          t = t.replace("data-lazy-", "");
          t = t.replace('loading="lazy"', "");
          t = t.replace(/<noscript>.*?<\/noscript>/g, "");
        }
        t = t.replace('alt=""', 'alt="' + alt + '"');
        return t.replace("ID", e) + a;
      }

      function lazyLoadYoutubeIframe() {
        var e = document.createElement("iframe"),
          t = "ID?autoplay=1";
        t +=
          0 === this.parentNode.dataset.query.length
            ? ""
            : "&" + this.parentNode.dataset.query;
        e.setAttribute("src", t.replace("ID", this.parentNode.dataset.src));
        e.setAttribute("frameborder", "0");
        e.setAttribute("allowfullscreen", "1");
        e.setAttribute(
          "allow",
          "accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
        );
        this.parentNode.parentNode.replaceChild(e, this.parentNode);
      }

      document.addEventListener("DOMContentLoaded", function () {
        var exclusions = [];
        var e,
          t,
          p,
          u,
          l,
          a = document.getElementsByClassName("rll-youtube-player");
        for (t = 0; t < a.length; t++)
          (e = document.createElement("div")),
            (u = "https://i.ytimg.com/vi/ID/hqdefault.jpg"),
            (u = u.replace("ID", a[t].dataset.id)),
            (l = exclusions.some((exclusion) => u.includes(exclusion))),
            e.setAttribute("data-id", a[t].dataset.id),
            e.setAttribute("data-query", a[t].dataset.query),
            e.setAttribute("data-src", a[t].dataset.src),
            (e.innerHTML = lazyLoadThumb(a[t].dataset.id, a[t].dataset.alt, l)),
            a[t].appendChild(e),
            (p = e.querySelector(".play")),
            (p.onclick = lazyLoadYoutubeIframe);
      });
    </script>

    <!-- Page-specific scripts -->
    <slot name="scripts" />

    <!-- Add analytics scripts -->
    <script>
      var themeVars = {
        home: "https://hushed.com",
        isHome: "",
        ajaxUrl: "https://hushed.com/wp-admin/admin-ajax.php",
        wpNonce: "4cfb6a1cd4",
      };
    </script>

    <!-- Add lazy loading scripts -->
    <script>
      window.lazyLoadOptions = {
        elements_selector: "iframe[data-lazy-src]",
        data_src: "lazy-src",
        data_srcset: "lazy-srcset",
        data_sizes: "lazy-sizes",
        class_loading: "lazyloading",
        class_loaded: "lazyloaded",
        threshold: 300,
        callback_loaded: function (element) {
          if (
            element.tagName === "IFRAME" &&
            element.dataset.rocketLazyload == "fitvidscompatible"
          ) {
            if (element.classList.contains("lazyloaded")) {
              if (typeof window.jQuery != "undefined") {
                if (jQuery.fn.fitVids) {
                  jQuery(element).parent().fitVids();
                }
              }
            }
          }
        },
      };
    </script>
    <script
      type="text/javascript"
      src="/js/templates/archive.js"
      id="template-archive-js"
      data-rocket-defer
      defer></script>
    <script
      type="text/javascript"
      src="/js/app.js"
      id="app-js"
      data-rocket-defer
      defer></script>
  </body>
</html>
